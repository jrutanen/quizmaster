<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="report.css">
    <script src="jquery-1.11.3.min.js"></script>
    <script src="d3.min.js"></script>

    <title>Leaderboard</title>
</head>
<script type="text/javascript">
    var results;
    var pollinterval;
    var pollcount = 0;

    function drawPage(){
        setInterval(updateData, 5000);
        $.get( "getresults.php", function( data ) {
//                alert( "Running page: " + data );
            results = JSON.parse( data );
//                gametime = setInterval(updateData, 1000);
//                drawChart(results);
//                alert("Results fetched.");
            var scores = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            var teamnames = ["Bacchus", "Belenus", "Doris", "Electra", "Hattifnattarna", "Midas",
                         "Nemesis", "Discordia&Hydra", "Sisyphus", "Vulcan"];
            for (i=0;i<results.length;i++) {
                if(results[i].player == "Bacchus") {
                    if(Number(results[i].score) < 5) {
                        scores[0] = scores[0] + Number(results[i].score);
                    } else {
                        scores[0] = scores[0] + 4;
                    }
                }
                if(results[i].player == "Belenus") {
                    if(Number(results[i].score) < 5) {
                        scores[1] = scores[1] + Number(results[i].score);
                    } else {
                        scores[1] = scores[1] + 4;
                    }
                }
                if(results[i].player == "Doris") {
                    if(Number(results[i].score) < 5) {
                        scores[2] = scores[2] + Number(results[i].score);
                    } else {
                        scores[2] = scores[2] + 4;
                    }
                }
                if(results[i].player == "Electra") {
                    if(Number(results[i].score) < 5) {
                        scores[3] = scores[3] + Number(results[i].score);
                    } else {
                        scores[3] = scores[3] + 4;
                    }
                }
                if(results[i].player == "Hattifnattarna") {
                    if(Number(results[i].score) < 5) {
                        scores[4] = scores[4] + Number(results[i].score);
                    } else {
                        scores[4] = scores[4] + 4;
                    }
                }
                if(results[i].player == "Midas") {
                    if(Number(results[i].score) < 5) {
                        scores[5] = scores[5] + Number(results[i].score);
                    } else {
                        scores[5] = scores[5] + 4;
                    }
                }
                if(results[i].player == "Nemesis") {
                    if(Number(results[i].score) < 5) {
                        scores[6] = scores[6] + Number(results[i].score);
                    } else {
                        scores[6] = scores[6] + 4;
                    }
                }
                if(results[i].player == "PowerTeam") {
                    if(Number(results[i].score) < 5) {
                        scores[7] = scores[7] + Number(results[i].score);
                    } else {
                        scores[7] = scores[7] + 4;
                    }
                }
                if(results[i].player == "Sisyphus") {
                    if(Number(results[i].score) < 5) {
                        scores[8] = scores[8] + Number(results[i].score);
                    } else {
                        scores[8] = scores[8] + 4;
                    }
                }
                if(results[i].player == "Vulcan") {
                    if(Number(results[i].score) < 5) {
                        scores[9] = scores[9] + Number(results[i].score);
                    } else {
                        scores[9] = scores[9] + 4;
                    }
                }
            }
            $(".chart").remove();
            $(".graph").append("<div class=chart>");
            for (i=0; i < scores.length;i++) {
                $(".chart").append(
                        "<div height='80px' id='" + scores[i]*9 + "px'>" + teamnames[i] + "</div>"
                );
            }
        });
    }
    function updateData() {

    }
    window.onload = drawPage;
</script>
<body>
<script type="text/javascript">
    document.body.className += ' has-script';
</script>
<div id="headline">
    <h1>Quiz Master Leader Board</h1>
    <br><br>
</div>
<div class=graph>
    <div class=chart>

    </div>
</div>
</body>
</html>
